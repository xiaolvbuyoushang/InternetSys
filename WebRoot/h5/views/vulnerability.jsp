<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ include file="common/header.jsp" %>
<style>
    /* 修改后的居中样式 */
    .container-centered {
        max-width: 800px;
        margin: 0 auto;
        padding: 0 15px;
    }

    .form-section {
        border-left: 4px solid #007bff;
        padding-left: 1.5rem;
        margin: 2rem 0;
        transition: all 0.3s ease;
    }

    .form-section:hover {
        border-color: #0056b3;
        background: #f8f9fa;
    }

    /* 新增居中相关样式 */
    .card {
        margin: 2rem auto;
    }

    .progress-step {
        flex: 0 0 auto;
        text-align: center;
    }

    .upload-box {
        margin: 0 auto;
    }

    /* 自定义样式 */
    .form-section {
        border-left: 4px solid #007bff;
        padding-left: 1.5rem;
        margin: 2rem 0;
        transition: all 0.3s ease;
    }

    .form-section:hover {
        border-color: #0056b3;
        background: #f8f9fa;
    }

    .form-label {
        font-weight: 600;
        color: #2c3e50;
    }

    .upload-box {
        border: 2px dashed #dee2e6;
        padding: 2rem;
        text-align: center;
        border-radius: 8px;
        transition: border-color 0.3s;
    }

    .upload-box:hover {
        border-color: #007bff;
        background: rgba(0, 123, 255, 0.05);
    }

    .btn-submit {
        letter-spacing: 1px;
        transition: transform 0.2s;
    }

    .btn-submit:hover {
        transform: translateY(-2px);
    }
</style>

<% currentPage = "vulnerability"; %>

<!-- 修改容器为居中布局 -->

<section class="container-centered mt-5">
    <div class="card border-0 shadow-lg">
        <div class="card-header bg-gradient-primary text-white py-4">
            <h3 class="mb-0">
                <i class="bi bi-bug me-2"></i>漏洞报告提交
                <small class="d-block mt-2 h6">请准确填写以下信息以便快速处理您的报告</small>
            </h3>
        </div>


        <form id="vulnForm" action="${pageContext.request.contextPath}/vuln/submit" method="post"
              enctype="multipart/form-data">
            <!-- 基本信息 -->
            <div class="form-section">
                <h5 class="mb-4"><i class="bi bi-info-circle me-2"></i>漏洞信息</h5>
                <div class="mb-4">
                    <label class="form-label">漏洞标题<span class="text-danger">*</span></label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-card-heading"></i></span>
                        <input type="text" name="title" class="form-control" placeholder="请输入明确的漏洞标题" required>
                    </div>
                </div>

                <div class="row g-3 mb-4">
                    <div class="col-md-6">
                        <label class="form-label">漏洞类型</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-tag"></i></span>
                            <select name="type" class="form-select">
                                <option value="web">Web应用漏洞</option>
                                <option value="mobile">移动端漏洞</option>
                                <option value="system">系统漏洞</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">危险等级</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-exclamation-triangle"></i></span>
                            <select name="level" class="form-select">
                                <option value="low">低危</option>
                                <option value="medium">中危</option>
                                <option value="high">高危</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 详细描述 -->
            <div class="form-section">
                <h5 class="mb-4"><i class="bi bi-file-text me-2"></i>详细描述</h5>
                <div class="mb-4">
                    <label class="form-label">漏洞描述<span class="text-danger">*</span></label>
                    <textarea name="description" class="form-control" rows="4"
                              placeholder="请详细描述漏洞现象和可能的影响" required></textarea>
                </div>

                <div class="mb-4">
                    <label class="form-label">影响范围</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-globe"></i></span>
                        <input type="text" name="scope" class="form-control" placeholder="例：所有v1.0版本的系统">
                    </div>
                </div>

                <div class="mb-4">
                    <label class="form-label">复现步骤</label>
                    <textarea name="steps" class="form-control" rows="5"
                              placeholder="请按步骤描述如何复现该漏洞"></textarea>
                    <small class="form-text text-muted">建议使用数字序号分步描述</small>
                </div>
            </div>

            <!-- 附件上传 -->
            <div class="form-section">
                <h5 class="mb-4"><i class="bi bi-paperclip me-2"></i>附件材料</h5>
                <div class="upload-box mb-3">
                    <i class="bi bi-cloud-upload display-6 text-muted mb-3"></i>
                    <p class="text-muted">拖放文件至此或点击上传</p>
                    <input type="file" name="attachment" class="form-control d-none"
                           accept=".jpg,.png,.pdf,.txt" id="fileInput">
                    <button type="button" class="btn btn-outline-primary"
                            onclick="document.getElementById('fileInput').click()">
                        选择文件
                    </button>
                    <div class="mt-2" id="fileList"></div>
                    <small class="form-text text-muted">支持格式：JPG/PNG/PDF/TXT，最大10MB</small>
                </div>
            </div>

            <!-- 提交按钮 -->
            <div class="d-grid gap-3 mt-5">
                <button type="submit" class="btn btn-danger btn-lg btn-submit">
                    <i class="bi bi-send-check me-2"></i>提交报告
                </button>
                <button type="reset" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-counterclockwise me-2"></i>重置表单
                </button>
            </div>
        </form>
    </div>
    </div>
</section>

<script>
    // 文件上传交互
    document.getElementById('fileInput').addEventListener('change', function (e) {
        const fileList = document.getElementById('fileList');
        fileList.innerHTML = Array.from(e.target.files).map(file =>
            `<div class="text-start text-success">
                <i class="bi bi-file-earmark-check"></i> ${file.name} (${(file.size/1024/1024).toFixed(2)}MB)
             </div>`
        ).join('');
    });

    // 表单验证反馈
    document.querySelectorAll('input, textarea').forEach(element => {
        element.addEventListener('invalid', () => {
            element.classList.add('is-invalid');
        });
        element.addEventListener('input', () => {
            if (element.checkValidity()) {
                element.classList.remove('is-invalid');
            }
        });
    });
</script>

<%@ include file="common/footer.jsp" %>
